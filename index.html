<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1">
    <title>Recipe Box</title>
    <!--Artist: Hopstarter-->
    <!--http://creativecommons.org/licenses/by-nc-nd/4.0/legalcode-->
    <!--http://www.iconarchive.com/show/sleek-xp-basic-icons-by-hopstarter/Document-Write-icon.html-->
    <link rel="icon" href="Hopstarter-Sleek-Xp-Basic-Document-Write.ico" type="image/x-icon" />
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet" type="text/css">    
    <link href="http://fonts.googleapis.com/css?family=Roboto:400,100,300,500,700,900" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="main.css">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <meta name="description" content="Zipline: Build a Recipe Box, A data visualization development projects.">
    <meta name="keywords" content="fcc, html, css, recipe box, javascript">
    <script src="react.js"></script>
    <script src="react-dom.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.6.16/browser.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
  </head>
  <body>
    <div id="contentText" ></div>
    <script type="text/babel">
      var Modal = React.createClass({
          
          closeModal: function( e ) {     
              this.props.displayModal();                                 
          },
          
          createRecipe: function( event ) {
              event.preventDefault( event );
              
              // 1. Collect data from form
              var recipeData = {
                recipeName: this.refs.recipeName.value,
                recipeDescription: this.refs.recipeDesc.value.split(",")                                            
              };
              
              // 2. Pass data to App
              this.props.addRecipe( recipeData );
              
              // 3. Reset Form
              this.refs.recipeForm.reset();
              
          },
          
          render: function() {
              var classes;
              if ( this.props.willDisplayModal ){
                  classes = "modal_container";
              } else {
                  classes = "modal_container showModal";
              }

              console.log( "Show modal : " + this.props.willDisplayModal );
              
              return (
                  <div id="myModal" className={classes} >
                    <div className="modal_content">
                      <div className="modal_header">
                        <span onClick={this.closeModal} className="modal_close">x</span> 
                        <h4>Add Recipe</h4>
                      </div>
                      <div className="modal_body">
                        <form onSubmit={this.createRecipe} ref="recipeForm">
                          <div className="form-group">
                            <label for="recipeName">Recipe Name</label>
                            <input type="text" className="form-control" id="recipeName"  placeholder="Enter your recipe name" ref="recipeName" />
                          </div>
                          <div className="form-group">
                            <label for="ingredients">Ingredients</label>
                            <textarea type="text" className="form-control" id="ingredients" placeholder="Enter ingredients separated by commas ex. coffee, sugar, cream" ref="recipeDesc"></textarea>
                          </div>
                          <button id="submit" className="btn pull-right" type="submit">Create Recipe</button>
                          <button id="myBtn" className="btn pull-right" type="button" onClick={this.closeModal}>Close</button>                         
                          <div className="clearfix"></div>
                        </form>
                      </div>
                      <div className="modal_footer">                                
                                                              
                      </div>                     
                    </div>                                 
                  </div>
              )
          }
      });
      
      var List = React.createClass({
             render: function() {
                 return (
                     <div>
                         <div className="list-group">                            
                             <button type="button" className="list-group-item"><span className="glyphicon glyphicon-list-alt" aria-hidden="true"></span>Roast Pork</button>
                             <button type="button" className="list-group-item"><span className="glyphicon glyphicon-list-alt" aria-hidden="true"></span>Chicken Panni</button>
                        </div>
                     </div>
                 )
             }
      });
      
      var Button = React.createClass({
          getModal: function(e) {
              this.props.setModal();
          },
          render: function(){
              
              return (
                  <button id="myBtn" className="btn" type="button" onClick={this.idp}>{this.props.buttonName}</button>
              )            
          }
      });
      
      var App = React.createClass({
        getInitialState: function() {
          return {
              showModal: false,
              recipes: [
                  {recipeName: "garlic chicken", ingredients: ["chicken", "garlic", "onion", "black pepper"]}, 
                  {recipeName: "Spaghetti", ingredients: ["Noodles", "Tomato sauce", "Meatballs"]}
              ]
          };
        },
        _addRecipe: function( recipe ) {
            var recipes;
            this.state.recipes.push( recipe );
            this.setState({
                recipes: this.state.recipes
            });
        },
        componentDidMount: function() {
          
          
        }, 
        componentWillUnmount: function() {
            
        },
        displayModal: function() {
           
           this.setState({
               showModal: !this.state.showModal
           });

            console.log( this.state );
            
        },
        _renderRecipeList: function(recipe, idx) {
            return (
                <button type="button" className="list-group-item" key={idx} index={idx}><span className="glyphicon glyphicon-list-alt" aria-hidden="true"></span>{recipe.recipeName}</button>
                <div className="panel">
                    <h4>{recipe.recipeName}</h4>
                    <ul>
                        
                    </ul>
                    <button type="button">Delete</button>
                    <button type="edit"></button>
                </div>
            )
        },
        render: function() {
          
          return (
           <div>
               <Modal displayModal={this.displayModal} addRecipe={this._addRecipe}  willDisplayModal={this.state.showModal} />   
              <div className="col-md-12">
                <header className="text-center">
                  <h1>Recipe Box</h1>
                </header>
                <div className="container col-md-12">
                  <div className="list-group">
                    {
                        this.state.recipes.map(this._renderRecipeList)
                    }
                  </div>
                  
                  <button id="myBtn" className="btn" type="button" onClick={this.displayModal}>Add Recipe</button>
                </div>     
              </div> 
              <pre>
                  {JSON.stringify(this.state, null, 2)}
              </pre>
           </div>            
          )
        }
      });
      
      ReactDOM.render( <App  />, document.getElementById("contentText") );
      
    </script>
  </body>
</html>